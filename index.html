<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BdF 定期刊行物監視ダッシュボード</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background-color: #ffffff; 
            line-height: 1.6;
        }
        .container { 
            max-width: 1400px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        h1 { 
            color: #333; 
            text-align: center; 
            margin-bottom: 10px;
            border-bottom: 3px solid #2563eb;
            padding-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        .info-bar {
            background: #f8f9fa;
            padding: 15px;
            border: 1px solid #ddd;
            margin-bottom: 20px;
            text-align: center;
            border-radius: 5px;
        }
        .last-update {
            font-size: 0.9em;
            color: #666;
            margin-top: 10px;
        }
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-top: 20px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        th, td { 
            border: 1px solid #ddd; 
            padding: 12px; 
            text-align: left; 
        }
        th { 
            background-color: #f5f5f5; 
            font-weight: bold;
            color: #333;
        }
        tr:nth-child(even) { 
            background-color: #f9f9f9; 
        }
        tr:hover { 
            background-color: #f0f0f0; 
        }
        .days-cell {
            font-size: 1.1em;
            font-weight: bold;
            text-align: center;
        }
        .note {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border: 1px solid #ddd;
            font-size: 0.9em;
            color: #666;
            border-radius: 5px;
        }
        .github-link {
            text-align: center;
            margin-top: 20px;
        }
        .github-link a {
            color: #2563eb;
            text-decoration: none;
            font-weight: bold;
        }
        .github-link a:hover {
            text-decoration: underline;
        }
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            table {
                font-size: 0.9em;
            }
            th, td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🏦 Banque de France 定期刊行物監視ダッシュボード</h1>
        <p class="subtitle">8つの定期刊行物を次回更新日順で監視</p>
        
        <div class="info-bar">
            <strong>監視対象:</strong> 8つの定期刊行物シリーズ |
            <strong>更新:</strong> 毎日自動更新 |
            <strong>通知:</strong> Gmail自動送信
            <div class="last-update" id="lastUpdate">最終更新: 2025-06-23 15:00:00 (パリ時間)</div>
        </div>

        <table>
            <thead>
                <tr>
                    <th>No</th>
                    <th>刊行物名</th>
                    <th>頻度</th>
                    <th>最新発行日</th>
                    <th>最新タイトル</th>
                    <th>次回予測</th>
                    <th>日数</th>
                    <th>状況</th>
                </tr>
            </thead>
            <tbody id="publicationsTable">
                <tr>
                    <td style="text-align: center; font-weight: bold;">1</td>
                    <td><strong>Financial Stability Report</strong></td>
                    <td>Semi-Annual</td>
                    <td>23rd of December 2024</td>
                    <td>Financial stability report - December 2024</td>
                    <td style="text-align: center;">2025-06-23</td>
                    <td class="days-cell">今日</td>
                    <td style="text-align: center;">🚨 本日予定</td>
                </tr>
                <tr>
                    <td style="text-align: center; font-weight: bold;">2</td>
                    <td><strong>Monthly Business Survey</strong></td>
                    <td>Monthly</td>
                    <td>11th of June 2025</td>
                    <td>Monthly Business Survey – Start of June 2025</td>
                    <td style="text-align: center;">2025-07-01</td>
                    <td class="days-cell">8日後</td>
                    <td style="text-align: center;">⏰ 期限間近</td>
                </tr>
                <tr>
                    <td style="text-align: center; font-weight: bold;">3</td>
                    <td><strong>Macroeconomic Projections</strong></td>
                    <td>Quarterly</td>
                    <td>11th of June 2025</td>
                    <td>Macroeconomic projections – June 2025</td>
                    <td style="text-align: center;">2025-09-15</td>
                    <td class="days-cell">84日後</td>
                    <td style="text-align: center;">✅ 正常</td>
                </tr>
                <tr>
                    <td style="text-align: center; font-weight: bold;">4</td>
                    <td><strong>Balance of Payments and International Investment Position</strong></td>
                    <td>Annual</td>
                    <td>15th of November 2024</td>
                    <td>France's balance of payments and international investment position 2023</td>
                    <td style="text-align: center;">2025-11-15</td>
                    <td class="days-cell">145日後</td>
                    <td style="text-align: center;">📅 予定あり</td>
                </tr>
                <tr>
                    <td style="text-align: center; font-weight: bold;">5</td>
                    <td><strong>Observatory for Security of Payment Means Report</strong></td>
                    <td>Annual</td>
                    <td>17th of January 2025</td>
                    <td>Annual Activity Report of the Observatory for Security of Payment Means 2023</td>
                    <td style="text-align: center;">2026-01-17</td>
                    <td class="days-cell">208日後</td>
                    <td style="text-align: center;">✅ 正常</td>
                </tr>
                <tr>
                    <td style="text-align: center; font-weight: bold;">6</td>
                    <td><strong>Letter to the President of the Republic</strong></td>
                    <td>Annual</td>
                    <td>18th of April 2025</td>
                    <td>Letter to the President: From stupefaction to general mobilisation</td>
                    <td style="text-align: center;">2026-04-18</td>
                    <td class="days-cell">299日後</td>
                    <td style="text-align: center;">✅ 正常</td>
                </tr>
                <tr>
                    <td style="text-align: center; font-weight: bold;">7</td>
                    <td><strong>Banque de France Annual Report</strong></td>
                    <td>Annual</td>
                    <td>20th of May 2025</td>
                    <td>Banque de France Annual Report 2024</td>
                    <td style="text-align: center;">2026-05-20</td>
                    <td class="days-cell">331日後</td>
                    <td style="text-align: center;">✅ 正常</td>
                </tr>
                <tr>
                    <td style="text-align: center; font-weight: bold;">8</td>
                    <td><strong>Interim Macroeconomic Projections</strong></td>
                    <td>Irregular</td>
                    <td>18th of September 2024</td>
                    <td>Interim macroeconomic projections – September 2024</td>
                    <td style="text-align: center;">不定期</td>
                    <td class="days-cell">N/A</td>
                    <td style="text-align: center;">⏸️ 停止</td>
                </tr>
            </tbody>
        </table>

        <div class="note">
            <h3>📊 状況説明</h3>
            <p><strong>🚨 本日予定:</strong> 発行予定日当日 | 
            <strong>⏰ 期限間近:</strong> 7日以内に予定 | 
            <strong>📅 予定あり:</strong> 30日以内に予定 | 
            <strong>✅ 正常:</strong> 30日超・正常範囲 | 
            <strong>⏸️ 停止:</strong> 刊行停止の可能性</p>
            
            <h3>🤖 システム機能</h3>
            <p>• <strong>自動監視:</strong> 毎日パリ時間7:00に自動チェック<br>
            • <strong>Gmail通知:</strong> 新しい刊行物が公表されたら即座にメール送信<br>
            • <strong>Webダッシュボード:</strong> このページで最新状況を確認可能<br>
            • <strong>データソース:</strong> <a href="https://www.banque-france.fr/en/publications-and-statistics/publications" target="_blank">Banque de France Publications</a></p>
        </div>

        <div class="github-link">
            <p>🔧 <a href="https://github.com/junshobara/bdf-monitoring" target="_blank">GitHub Repository</a> | 
            📧 自動通知システム稼働中</p>
        </div>
    </div>

    <script>
        // 現在時刻を更新
        function updateTime() {
            const now = new Date();
            const parisTime = now.toLocaleString('ja-JP', {
                timeZone: 'Europe/Paris',
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('lastUpdate').textContent = `最終更新: ${parisTime} (パリ時間)`;
        }

        // 日数の動的計算
        function updateDaysUntil() {
            const publications = [
                { nextDate: '2025-06-23', row: 0 }, // Financial Stability Report
                { nextDate: '2025-07-01', row: 1 }, // Monthly Business Survey
                { nextDate: '2025-09-15', row: 2 }, // Macroeconomic Projections
                { nextDate: '2025-11-15', row: 3 }, // Balance of Payments
                { nextDate: '2026-01-17', row: 4 }, // Observatory
                { nextDate: '2026-04-18', row: 5 }, // Letter to President
                { nextDate: '2026-05-20', row: 6 }, // Annual Report
            ];

            const today = new Date();
            const tableRows = document.querySelectorAll('#publicationsTable tr');

            publications.forEach(pub => {
                const nextDate = new Date(pub.nextDate);
                const diffTime = nextDate - today;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                const daysCell = tableRows[pub.row].cells[6];
                const statusCell = tableRows[pub.row].cells[7];
                
                if (diffDays === 0) {
                    daysCell.textContent = '今日';
                    statusCell.innerHTML = '🚨 本日予定';
                } else if (diffDays > 0) {
                    daysCell.textContent = `${diffDays}日後`;
                    if (diffDays <= 7) {
                        statusCell.innerHTML = '⏰ 期限間近';
                    } else if (diffDays <= 30) {
                        statusCell.innerHTML = '📅 予定あり';
                    } else {
                        statusCell.innerHTML = '✅ 正常';
                    }
                } else {
                    daysCell.textContent = `${Math.abs(diffDays)}日超過`;
                    statusCell.innerHTML = '⚠️ 期限超過';
                }
            });
        }

        // 初期化
        updateTime();
        updateDaysUntil();
        
        // 1分ごとに更新
        setInterval(() => {
            updateTime();
            updateDaysUntil();
        }, 60000);
    </script>
</body>
</html>